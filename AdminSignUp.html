<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="CSS/Adminsignup.css">
    <script src="https://kit.fontawesome.com/8fada4f271.js" crossorigin="anonymous"></script>
    
    <title>Admin Sign up</title>
</head>
<header>
    <div class="nav">
        <p>Admin Sign Up</p>
        <a href="index.html"><i class="fa-solid fa-house"></i></a>
    
    </div>
</header>
<body>
    <div class="container">
        <!-- <button onclick="googleSignIn()" class="Sign_in">Signin as Admin</button> -->
        <button onclick="googleSignUp('teacher')" class="Sign_up">SignUp/SignIn as Admin</button>
    </div>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyDS79FNi8oEhUWKvdvNOPgEDIFSay4Wj1M",
            authDomain: "infinity-try.firebaseapp.com",
            projectId: "infinity-try",
            storageBucket: "infinity-try.firebasestorage.app",
            messagingSenderId: "326631894819",
            appId: "1:326631894819:web:6b50d91212a260af792696",
            measurementId: "G-W55EB5PVH7"
            };
            firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            function googleSignUp(role) {
    const provider = new firebase.auth.GoogleAuthProvider();

    firebase.auth().signInWithPopup(provider)
        .then((result) => {
            const user = result.user;
            if (user) {
                const userRef = db.collection("users").doc(user.uid);

                // Check if user already exists in Firestore
                userRef.get().then((doc) => {
                    if (!doc.exists) {
                        // If user is new, store their details in Firestore
                        userRef.set({
                            name: user.displayName,
                            email: user.email,
                            role: role, // Assign role (student or teacher)
                            createdAt: firebase.firestore.FieldValue.serverTimestamp()
                        }).then(() => {
                            console.log("User signed up successfully!");
                            alert("Sign-Up Successful! Redirecting...");
                            // Redirect based on role
                            if (role === "teacher") {
                                window.location.href = "Admin.html";
                            } else {
                                alert("Get Lost No Students Here !");;
                            }
                        }).catch(error => console.error("Error saving user data:", error));
                    } else {
                        alert("You are already registered! Please log in.");
                    }
                });
            }
        })
        .catch(error => {
            console.error("Google Sign-Up Error:", error);
        });
}

    </script>
</body>
</html>